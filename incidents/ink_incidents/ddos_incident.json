{"inkVersion":21,"root":[["^High Error Rate in Android API","\n","^Your goal is to investigate and mitigate the issue while ensuring minimal impact on the system.","\n",{"->":"start_investigation"},["done",{"#f":5,"#n":"g-0"}],null],"done",{"start_investigation":[["^It is 3 am, and we received an alert for a high error rate in the Android API.","\n","^WHAT DO YOU DO FIRST?","\n","ev","str","^Check the Android API APM","/str","/ev",{"*":".^.c-0","flg":4},"ev","str","^Ignore the alert for now","/str","/ev",{"*":".^.c-1","flg":20},{"c-0":["^ Investigate error rates and throughput trends. ",{"->":"analyze_apm"},"\n",{"#f":5}],"c-1":["^ Decide not to take immediate action. ",{"->":"ignore_alert"},"\n",{"#f":5}]}],{"#f":1}],"analyze_apm":[["^You check the Android API APM and find that throughput is unusually high compared to the previous day/week.","\n","^WHAT DO YOU CONCLUDE?","\n","ev","str","^It’s a potential DDoS attack","/str","/ev",{"*":".^.c-0","flg":20},"ev","str","^It’s a transient spike","/str","/ev",{"*":".^.c-1","flg":20},{"c-0":["^ High throughput suggests unusual traffic patterns. ",{"->":"check_order_dashboard"},"\n",{"#f":5}],"c-1":["^ Assume it might stabilize. ",{"->":"ignore_alert"},"\n",{"#f":5}]}],{"#f":1}],"check_order_dashboard":[["^You check the order dashboard to see if order placement is impacted.","\n","^WHAT DO YOU FIND?","\n","ev","str","^No impact on orders","/str","/ev",{"*":".^.c-0","flg":20},"ev","str","^Impact on orders detected","/str","/ev",{"*":".^.c-1","flg":20},{"c-0":["^ No incident needs to be created yet. ",{"->":"identify_attack_pattern"},"\n",{"#f":5}],"c-1":["^ Create an incident immediately. ",{"->":"create_incident"},"\n",{"#f":5}]}],{"#f":1}],"create_incident":[["^You determine that the high error rate impacts order placement.","\n","^WHAT DO YOU DO NEXT?","\n","ev","str","^Identify Attack Pattern","/str","/ev",{"*":".^.c-0","flg":20},{"c-0":["^ Inform the on-call team and relevant stakeholders. ",{"->":"identify_attack_pattern"},"\n",{"#f":5}]}],{"#f":1}],"identify_attack_pattern":[["^You begin identifying the attack pattern using New Relic Transaction Queries and Cloudflare Security Analytics.","\n","^HINT: Use these references:","\n",["^<a target=\"_blank\" href=\"https://one.newrelic.com/alerts/issue?account=938958&state=ab6c5acf-c9d7-2e32-68f7-63e49703a82c\">New Relic Alert</a>","\n",["^<a target=\"_blank\" href=\"https://dash.cloudflare.com/a24d979a90c8bac120ac9b36256f0d41/talabat.com/security/analytics\">Cloudflare Security Analytics</a>","\n","^WHAT DO YOU DISCOVER?","\n","ev","str","^Attack on `/apiAndroid/v1/AuthToken`","/str","/ev",{"*":".^.c-0","flg":4},"ev","str","^No clear pattern","/str","/ev",{"*":".^.c-1","flg":20},{"c-0":["^ Most attacks target this URI. ",{"->":"investigate_ja3"},"\n",{"#f":5}],"c-1":["^ Continue monitoring traffic. ",{"->":"monitor_traffic"},"\n",{"#f":5}],"#f":5,"#n":"g-1"}],{"#f":5,"#n":"g-0"}],null],{"#f":1}],"investigate_ja3":[["^You identify that most of the attacks share the same JA3 fingerprint.","\n","^WHAT IS JA3?","\n","^JA3 is a method of creating a unique fingerprint for SSL/TLS clients based on the parameters they use during a connection.","\n","^HINT: Learn more <a target=\"_blank\" href=\"https://dash.cloudflare.com/a24d979a90c8bac120ac9b36256f0d41/talabat.com/security/analytics\">here</a>","\n","^WHAT DO YOU DO NEXT?","\n","ev","str","^Investigate JA3 across the last week/month","/str","/ev",{"*":".^.c-0","flg":4},"ev","str","^No need to check JA3 analysis; I’ll just stare at CF and hope for clarity.","/str","/ev",{"*":".^.c-1","flg":20},{"c-0":["^ You identified all requests coming from same JA3 fingerprint is correlated to attacks only during last 1 week. ",{"->":"create_firewall_rule"},"\n",{"#f":5}],"c-1":["^ ",{"->":".^.^.^"},"\n",{"#f":5}]}],{"#f":1}],"create_firewall_rule":[["^Now You need to create a new Cloudflare firewall rule to match requests with the same JA3 causing the attack.","\n","^HINT: Use this reference for creating rules:","\n","^<a href=\"https://dash.cloudflare.com/a24d979a90c8bac120ac9b36256f0d41/talabat.com/security/waf/firewall-rules\">rule</a>","\n","^WHAT ACTION DO YOU TAKE INITIALLY?","\n","ev","str","^Set the rule to log only","/str","/ev",{"*":".^.c-0","flg":20},"ev","str","^Immediately block traffic","/str","/ev",{"*":".^.c-1","flg":20},{"c-0":["^ Monitor the rule to ensure no unexpected impact. ",{"->":"monitor_firewall"},"\n",{"#f":5}],"c-1":["^ Block traffic matching the JA3 fingerprint. ",{"->":"assess_impact"},"\n",{"#f":5}]}],{"#f":1}],"assess_impact":[["^The new firewall rule starts blocking traffic.","\n","^HOW DO YOU VERIFY THE IMPACT?","\n","^HINT: Compare traffic before and after the rule implementation using Cloudflare Security Analytics.","\n",["^<a href=\"https://dash.cloudflare.com/a24d979a90c8bac120ac9b36256f0d41/talabat.com/security/analytics\">Cloudflare Security Analytics</a>","\n","ev","str","^Rule is effective","/str","/ev",{"*":".^.c-0","flg":20},"ev","str","^Unexpected issues arise","/str","/ev",{"*":".^.c-1","flg":20},{"c-0":["^ The attack traffic is mitigated with no side effects. ",{"->":"share_with_security"},"\n",{"#f":5}],"c-1":["^ Refine or disable the rule to reduce negative impact. ",{"->":"investigate_remaining_requests"},"\n",{"#f":5}],"#f":5,"#n":"g-0"}],null],{"#f":1}],"monitor_firewall":[["^You monitor the rule for a few minutes and confirm it matches the expected attack throughput.","\n","^WHAT DO YOU DO NEXT?","\n","ev","str","^Change the action to block","/str","/ev",{"*":".^.c-0","flg":20},{"c-0":["^ Block the attack using the firewall rule. ",{"->":"share_with_security"},"\n",{"#f":5}]}],{"#f":1}],"share_with_security":[["^You share the new firewall rule with the security team for validation and documentation.","\n","^WHAT DO YOU OBSERVE?","\n","ev","str","^Most attacks are blocked","/str","/ev",{"*":".^.c-0","flg":20},{"c-0":["^ The rule is effective. ",{"->":"evaluate_results"},"\n",{"#f":5}]}],{"#f":1}],"investigate_remaining_requests":[["^You observe that some attack requests are bypassing the firewall rules.","\n","^WHAT DO YOU DO NEXT?","\n","ev","str","^Refine the firewall rule","/str","/ev",{"*":".^.c-0","flg":20},{"c-0":["^ Update the rule to better match attack patterns. ",{"->":"share_with_security"},"\n",{"#f":5}]}],{"#f":1}],"evaluate_results":[["^The majority of the attack has been mitigated.","\n","^WHAT IS YOUR NEXT STEP?","\n","ev","str","^Monitor & Escalate to engineering/security","/str","/ev",{"*":".^.c-0","flg":20},{"c-0":["^ Keep Monitoring and Share findings and collaborate on a long-term solution. ","done","\n",{"#f":5}]}],{"#f":1}],"monitor_traffic":[["^You decide to monitor the situation further without taking immediate action.","\n","^WHAT DO YOU DO NEXT?","\n","ev","str","^Escalate the issue","/str","/ev",{"*":".^.c-0","flg":20},{"c-0":["^ Notify the security or engineering team for further support. ",{"->":"identify_attack_pattern"},"\n",{"#f":5}]}],{"#f":1}],"ignore_alert":[["^Ignoring the alert could lead to severe consequences.","\n","^ARE YOU SURE?","\n","ev","str","^Go back and take action","/str","/ev",{"*":".^.c-0","flg":4},"ev","str","^Yes, ignore for now","/str","/ev",{"*":".^.c-1","flg":20},{"c-0":["^ ",{"->":"start_investigation"},"\n",{"#f":5}],"c-1":["^ ","done","\n",{"#f":5}]}],{"#f":1}],"DONE":[["^The playbook is complete. Ensure to:","\n",["^Share findings in the post-incident report.","\n",["^Collaborate with the security team for further analysis and prevention strategies.","\n","^END OF PLAYBOOK.","\n","end",{"#f":5,"#n":"g-1"}],{"#f":5,"#n":"g-0"}],null],{"#f":1}],"#f":1}],"listDefs":{}}