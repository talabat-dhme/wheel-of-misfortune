{"inkVersion":21,"root":[["#","^High Error Rate in Android API 🚨","/#",{"->":"start_investigation"},["done",{"#f":5,"#n":"g-0"}],null],"done",{"start_investigation":[["^<b>It's 3 AM, and your phone is screaming with alerts! 😱 High error rate in the Android API! Your heart races, your eyes blur. It's incident response time!</b> ☕","\n","ev","str","^Check the Android API APM. (Time to investigate!)","/str","/ev",{"*":".^.c-0","flg":4},"ev","str","^Ignore the alert for now. (But the app might be on fire!)","/str","/ev",{"*":".^.c-1","flg":20},{"c-0":["^ ",{"->":"analyze_apm"},"\n",{"#f":5}],"c-1":["^ ",{"->":"incident_neglect_start_investigation"},"\n","end",{"#f":5}]}],{"#f":1}],"analyze_apm":[["^<b>You check the Android API APM. Throughput is unusually high compared to the previous day/week. (Something's fishy!)</b>","\n","ev","str","^It’s a potential DDoS attack! (Uh oh, incoming traffic tsunami!)","/str","/ev",{"*":".^.c-0","flg":4},"ev","str","^It’s a transient spike. (Are you sure you want to gamble with the app's stability?)","/str","/ev",{"*":".^.c-1","flg":20},{"c-0":["^ ",{"->":"check_order_dashboard_question"},"\n",{"#f":5}],"c-1":["^ ",{"->":"incident_neglect_analyze_apm"},"\n","end",{"#f":5}]}],{"#f":1}],"check_order_dashboard_question":[["^<b>You check the order dashboard to see if order placement is impacted. (Are customers getting hangry?)</b>","\n","ev","str","^Q: How to check if there is order impact? (Where's the order panic button?)","/str","/ev",{"*":".^.c-0","flg":4},{"c-0":["^ ",{"->":"check_order_dashboard_answer"},"\n",{"#f":5}]}],{"#f":1}],"check_order_dashboard_answer":[["^<b>We can check the impact on orders by checking the <a target=\"_blank\" href=\"https://onenr.io/0dQeqgG1rQe\" style=\"color: blue;text-decoration: underline;\">Shopping Dashboard</a>. (Hold your breath!)</b>","\n","ev","str","^Impact on orders detected!","/str","/ev",{"*":".^.c-0","flg":4},"ev","str","^No impact on orders or customer experience affected.","/str","/ev",{"*":".^.c-1","flg":4},{"c-0":["^ ",{"->":"create_incident"},"\n",{"#f":5}],"c-1":["^ ",{"->":"identify_attack_pattern"},"\n",{"#f":5}]}],{"#f":1}],"create_incident":[["^<b>You determine that the high error rate impacts order placement. (Time to sound the alarm!)</b>","\n","ev","str","^Identify Attack Pattern. (Let's hunt down the culprit!)","/str","/ev",{"*":".^.c-0","flg":4},{"c-0":["^ ",{"->":"identify_attack_pattern"},"\n",{"#f":5}]}],{"#f":1}],"identify_attack_pattern":[["^<b>You begin identifying the attack pattern using New Relic Transaction Queries and Cloudflare Security Analytics. (Time to put on your detective hat!)</b>","\n","^HINT: Use these references:","\n",["^<a target=\"_blank\" href=\"https://one.newrelic.com/alerts/issue?account=938958&state=ab6c5acf-c9d7-2e32-68f7-63e49703a82c\" style=\"color: blue;text-decoration: underline;\">New Relic Alert</a>","\n",["^<a target=\"_blank\" href=\"https://dash.cloudflare.com/a24d979a90c8bac120ac9b36256f0d41/talabat.com/security/analytics\" style=\"color: blue;text-decoration: underline;\">Cloudflare Security Analytics</a>","\n","ev","str","^Attack on `/apiAndroid/v1/AuthToken`! (The AuthToken is under attack!)","/str","/ev",{"*":".^.c-0","flg":4},"ev","str","^No clear pattern. (But the chaos continues!)","/str","/ev",{"*":".^.c-1","flg":20},{"c-0":["^ ",{"->":"investigate_ja3"},"\n",{"#f":5}],"c-1":["^ ",{"->":"incident_neglect_identify_attack_pattern"},"\n","end",{"#f":5}],"#f":5,"#n":"g-1"}],{"#f":5,"#n":"g-0"}],null],{"#f":1}],"investigate_ja3":[["^<b>You identify that most of the attacks share the same JA3 fingerprint. (Aha! A digital fingerprint!)</b>","\n","^WHAT IS JA3?","\n","^JA3 is a method of creating a unique fingerprint for SSL/TLS clients based on the parameters they use during a connection.","\n","^HINT: Learn more <a target=\"_blank\" href=\"https://dash.cloudflare.com/a24d979a90c8bac120ac9b36256f0d41/talabat.com/security/analytics\" style=\"color: blue;text-decoration: underline;\">here</a>","\n","ev","str","^Investigate JA3 across the last week/month. (Let's track down this digital bandit!)","/str","/ev",{"*":".^.c-0","flg":4},"ev","str","^No need to check JA3 analysis; I’ll just stare at CF and hope for clarity. (Hope is not a strategy, my friend!)","/str","/ev",{"*":".^.c-1","flg":20},{"c-0":["^ ",{"->":"create_firewall_rule"},"\n",{"#f":5}],"c-1":["^ ",{"->":"incident_neglect_investigate_ja3"},"\n","end",{"#f":5}]}],{"#f":1}],"create_firewall_rule":[["^<b>Now you need to create a new Cloudflare firewall rule to match requests with the same JA3 causing the attack. (Time to build a digital fortress!)</b>","\n","^HINT: Use this reference for creating rules:","\n","^<a href=\"https://dash.cloudflare.com/a24d979a90c8bac120ac9b36256f0d41/talabat.com/security/waf/firewall-rules\" style=\"color: blue;text-decoration: underline;\">rule</a>","\n","ev","str","^Set the rule to log only. (Let's be cautious and observe first!)","/str","/ev",{"*":".^.c-0","flg":4},"ev","str","^Immediately block traffic. (But what if you block legitimate users?)","/str","/ev",{"*":".^.c-1","flg":20},{"c-0":["^ ",{"->":"monitor_firewall"},"\n",{"#f":5}],"c-1":["^ ",{"->":"incident_neglect_create_firewall_rule"},"\n","end",{"#f":5}]}],{"#f":1}],"monitor_firewall":[["^<b>You monitor the rule for a few minutes and confirm it matches the expected attack throughput. (Looking good so far!)</b>","\n","ev","str","^Change the action to block. (Time to unleash the firewall!)","/str","/ev",{"*":".^.c-0","flg":4},"ev","str","^Continue monitoring. (But the attackers are still slipping through!)","/str","/ev",{"*":".^.c-1","flg":20},{"c-0":["^ ",{"->":"share_with_security"},"\n",{"#f":5}],"c-1":["^ ",{"->":"incident_neglect_monitor_firewall"},"\n","end",{"#f":5}]}],{"#f":1}],"share_with_security":[["^<b>You share the new firewall rule with the security team for validation and documentation. (Teamwork makes the dream work!)</b>","\n","ev","str","^Most attacks are blocked.","/str","/ev",{"*":".^.c-0","flg":4},"ev","str","^Some requests still pass. (Uh oh, the attackers are finding loopholes!)","/str","/ev",{"*":".^.c-1","flg":20},{"c-0":["^ ",{"->":"evaluate_results"},"\n",{"#f":5}],"c-1":["^ ",{"->":"investigate_remaining_requests"},"\n",{"#f":5}]}],{"#f":1}],"investigate_remaining_requests":[["^<b>You observe that some attack requests are bypassing the firewall rules. (The attackers are evolving!)</b>","\n","ev","str","^Refine the firewall rule. (Time to strengthen the defenses!)","/str","/ev",{"*":".^.c-0","flg":4},{"c-0":["^ ",{"->":"share_with_security"},"\n",{"#f":5}]}],{"#f":1}],"evaluate_results":[["^<b>The majority of the attack has been mitigated. (Victory is in sight!)</b>","\n","ev","str","^Monitor & Escalate to engineering/security. (Let's keep an eye on things and plan for the future!)","/str","/ev",{"*":".^.c-0","flg":4},{"c-0":["^ ","done","\n",{"#f":5}]}],{"#f":1}],"monitor_traffic":[["^<b>You decide to monitor the situation further without taking immediate action. (But the app is still under siege!)</b>","\n","ev","str","^Escalate the issue. (Time to call in the reinforcements!)","/str","/ev",{"*":".^.c-0","flg":4},{"c-0":["^ ",{"->":"identify_attack_pattern"},"\n",{"#f":5}]}],{"#f":1}],"ignore_alert":[["^<b>Ignoring the alert could lead to severe consequences. (Are you sure you want to risk it?)</b>","\n","ev","str","^Go back and take action. (Let's be responsible!)","/str","/ev",{"*":".^.c-0","flg":4},"ev","str","^Yes, ignore for now. (You're playing a dangerous game!)","/str","/ev",{"*":".^.c-1","flg":20},{"c-0":["^ ",{"->":"start_investigation"},"\n",{"#f":5}],"c-1":["^ ","done","\n",{"#f":5}]}],{"#f":1}],"DONE":[["^<b>The playbook is complete. Ensure to:</b>","\n",["^Share findings in the post-incident report.","\n",["^Collaborate with the security team for further analysis and prevention strategies.","\n","^<b>END OF PLAYBOOK.</b>","\n","end",{"#f":5,"#n":"g-1"}],{"#f":5,"#n":"g-0"}],null],{"#f":1}],"incident_neglect_start_investigation":[["^💀 **Oh no! Ignoring the alert was a critical error. The app is crashing, users are panicking, and the CEO is calling. Time to wake up and smell the coffee!** ☕","\n","ev","str","^Try again? (Let's not hit the snooze button on this one!)","/str","/ev",{"*":".^.c-0","flg":4},{"c-0":["^ ",{"->":"start_investigation"},"\n",{"#f":5}]}],{"#f":1}],"incident_neglect_analyze_apm":[["^💀 **Oh dear! Assuming it was a transient spike was a miscalculation. The error rate skyrocketed, and the app is now a digital wasteland. Time to face the consequences!** 💥","\n","ev","str","^Try again? (Let's not underestimate the power of spikes!)","/str","/ev",{"*":".^.c-0","flg":4},{"c-0":["^ ",{"->":"analyze_apm"},"\n",{"#f":5}]}],{"#f":1}],"incident_neglect_identify_attack_pattern":[["^💀 **Oh no! Ignoring the attack pattern was a grave mistake. The attackers are now having a party on your servers, and the data is doing the conga line out the door. Time to take charge!** 🎉","\n","ev","str","^Try again? (Let's identify those sneaky attackers!)","/str","/ev",{"*":".^.c-0","flg":4},{"c-0":["^ ",{"->":"identify_attack_pattern"},"\n",{"#f":5}]}],{"#f":1}],"incident_neglect_investigate_ja3":[["^💀 **Oh dear! Ignoring the JA3 fingerprint was a missed opportunity. The attackers are now morphing their digital disguises, and the firewall is powerless. Time to embrace the power of JA3!** 🕵️‍♀️","\n","ev","str","^Try again? (Let's track down those digital chameleons!)","/str","/ev",{"*":".^.c-0","flg":4},{"c-0":["^ ",{"->":"investigate_ja3"},"\n",{"#f":5}]}],{"#f":1}],"incident_neglect_create_firewall_rule":[["^💀 **Oh no! Blocking traffic without caution was a disaster. Legitimate users are locked out, and the app is a ghost town. Time to refine your firewall strategy!** 👻","\n","ev","str","^Try again? (Let's be more strategic with our blocks!)","/str","/ev",{"*":".^.c-0","flg":4},{"c-0":["^ ",{"->":"create_firewall_rule"},"\n",{"#f":5}]}],{"#f":1}],"incident_neglect_monitor_firewall":[["^💀 **Oh dear! Continuing to monitor without action was a costly mistake. The attackers are now sipping cocktails on your servers, and the data is doing the limbo under the firewall. Time to take action!** 🍹","\n","ev","str","^Try again? (Let's block those party crashers!)","/str","/ev",{"*":".^.c-0","flg":4},{"c-0":["^ ",{"->":"monitor_firewall"},"\n",{"#f":5}]}],{"#f":1}],"#f":1}],"listDefs":{}}